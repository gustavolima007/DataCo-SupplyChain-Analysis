table fato_vendas
	lineageTag: 3a2227c8-6fcf-4b01-bef9-630ee7ba409e

	column 'Data do Pedido'
		dataType: dateTime
		formatString: Short Date
		lineageTag: e5b504f7-29d1-4596-b955-40f401cc3dcf
		summarizeBy: none
		sourceColumn: Data do Pedido

		annotation SummarizationSetBy = Automatic

		annotation UnderlyingDateTimeDataType = Date

	column 'Data de Envio'
		dataType: dateTime
		formatString: Short Date
		lineageTag: f9b70bf8-1cab-43d8-be29-84ced0cfca35
		summarizeBy: none
		sourceColumn: Data de Envio

		variation Variation
			isDefault
			relationship: 738e1857-904a-456d-87b0-6ff89a31deb1
			defaultHierarchy: LocalDateTable_03f298f8-7b6d-4e3a-bfd8-9a9f99005ec7.'Hierarquia de datas'

		annotation SummarizationSetBy = Automatic

		annotation UnderlyingDateTimeDataType = Date

	column 'Tipo de Pagamento'
		dataType: string
		lineageTag: 5759cd26-9084-4787-a5d8-fd17a79c0c22
		summarizeBy: none
		sourceColumn: Tipo de Pagamento

		annotation SummarizationSetBy = Automatic

	column 'Dias Envio Real'
		dataType: int64
		formatString: 0
		lineageTag: 1c4d2365-a5a9-403b-8571-913d755e8d32
		summarizeBy: sum
		sourceColumn: Dias Envio Real

		annotation SummarizationSetBy = Automatic

	column 'Dias Envio Programado'
		dataType: int64
		formatString: 0
		lineageTag: 9b06fbdd-1c5a-4066-9466-d900c7f604b6
		summarizeBy: sum
		sourceColumn: Dias Envio Programado

		annotation SummarizationSetBy = Automatic

	column 'Risco de Atraso'
		dataType: int64
		lineageTag: c0fbbf16-61ec-4a56-98c9-e70cc7f17e8f
		summarizeBy: sum
		sourceColumn: Risco de Atraso

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column 'Nome da Categoria'
		dataType: string
		lineageTag: 6b6c01a0-a0f1-4ea2-9bdd-162e238712c0
		summarizeBy: none
		sourceColumn: Nome da Categoria

		annotation SummarizationSetBy = Automatic

	column 'Segmento do Cliente'
		dataType: string
		lineageTag: 5ca844e7-32ee-4fe9-9490-728e83b2fd0f
		summarizeBy: none
		sourceColumn: Segmento do Cliente

		annotation SummarizationSetBy = Automatic

	column 'Nome do Departamento'
		dataType: string
		lineageTag: 8e93acbb-dc98-44b7-9978-3218f2738e71
		summarizeBy: none
		sourceColumn: Nome do Departamento

		annotation SummarizationSetBy = Automatic

	column 'Cidade do Pedido'
		dataType: string
		lineageTag: 2e7b0569-f00e-4bfd-8895-07d950779706
		summarizeBy: none
		sourceColumn: Cidade do Pedido

		annotation SummarizationSetBy = Automatic

	column 'País do Pedido'
		dataType: string
		lineageTag: 9e75e3b5-1543-4142-aacc-235af3fc9fd7
		summarizeBy: none
		sourceColumn: País do Pedido

		annotation SummarizationSetBy = Automatic

	column 'Região do Pedido'
		dataType: string
		lineageTag: 6014c761-5619-4ba6-810c-2a55fa9ade6b
		summarizeBy: none
		sourceColumn: Região do Pedido

		annotation SummarizationSetBy = Automatic

	column 'Situação do Pedido'
		dataType: string
		lineageTag: 76576158-df58-435a-a4ce-5e7f5544208e
		summarizeBy: none
		sourceColumn: Situação do Pedido

		annotation SummarizationSetBy = Automatic

	column 'Nome do Produto'
		dataType: string
		lineageTag: 6949bb3a-947f-4099-9d0e-afc8434d7273
		summarizeBy: none
		sourceColumn: Nome do Produto

		annotation SummarizationSetBy = Automatic

	column Vendas
		dataType: double
		lineageTag: 426498e2-9e87-4eb0-b680-a9dc4daef8c1
		summarizeBy: sum
		sourceColumn: Vendas

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column 'Lucro do Pedido'
		dataType: double
		lineageTag: 8c3a33d5-983b-4d77-9bbe-ff6156c64cde
		summarizeBy: sum
		sourceColumn: Lucro do Pedido

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column 'ID do Pedido'
		dataType: int64
		formatString: 0
		lineageTag: 861ec635-d295-4e08-ba3b-a67d95647f1a
		summarizeBy: sum
		sourceColumn: ID do Pedido

		annotation SummarizationSetBy = Automatic

	column 'Mercado Global'
		dataType: string
		lineageTag: 64e981c1-aaee-42c4-9faa-1ec49e1e35b2
		summarizeBy: none
		sourceColumn: Mercado Global

		annotation SummarizationSetBy = Automatic

	column 'Modalidade de Entrega'
		dataType: string
		lineageTag: e8999890-cdd0-4d18-8d64-40d059651b54
		summarizeBy: none
		sourceColumn: Modalidade de Entrega

		annotation SummarizationSetBy = Automatic

	column 'Status do Pedido'
		dataType: string
		lineageTag: 58d17272-4416-4017-8ec9-153cab3511c4
		summarizeBy: none
		sourceColumn: Status do Pedido

		annotation SummarizationSetBy = Automatic

	column Flag
		dataType: string
		lineageTag: ae54ab98-74d2-4ffd-bdbd-538db6f99e1e
		dataCategory: ImageUrl
		summarizeBy: none
		sourceColumn: Flag

		annotation SummarizationSetBy = Automatic

	column 'No Prazo Flag' = IF(fato_vendas[Dias Envio Real] <= fato_vendas[Dias Envio Programado], 1, 0)
		formatString: 0
		lineageTag: 996bb7b5-8f3f-47ab-9355-e84038038db8
		summarizeBy: sum

		annotation SummarizationSetBy = Automatic

	column 'Categoria BR' = ```
			
			SWITCH (
			    TRUE(),
			
			    'fato_vendas'[Nome da Categoria] = "Accessories", "Acessórios",
			    'fato_vendas'[Nome da Categoria] = "As Seen on  TV!", "Promocionais",
			    'fato_vendas'[Nome da Categoria] = "Baby", "Bebês",
			    'fato_vendas'[Nome da Categoria] = "Baseball & Softball", "Esportivos",
			    'fato_vendas'[Nome da Categoria] = "Basketball", "Esportivos",
			    'fato_vendas'[Nome da Categoria] = "Books", "Livros",
			    'fato_vendas'[Nome da Categoria] = "Boxing & MMA", "Esportivos",
			    'fato_vendas'[Nome da Categoria] = "Cameras", "Câmeras",
			    'fato_vendas'[Nome da Categoria] = "Camping & Hiking", "Camping",
			    'fato_vendas'[Nome da Categoria] = "Cardio Equipment", "Fitness",
			    'fato_vendas'[Nome da Categoria] = "CDs", "Mídias",
			    'fato_vendas'[Nome da Categoria] = "Children's Clothing", "Vestuário",
			    'fato_vendas'[Nome da Categoria] = "Cleats", "Calçados",
			    'fato_vendas'[Nome da Categoria] = "Consumer Electronics", "Eletrônicos",
			    'fato_vendas'[Nome da Categoria] = "Crafts", "Artesanato",
			    'fato_vendas'[Nome da Categoria] = "DVDs", "Mídias",
			    'fato_vendas'[Nome da Categoria] = "Electronics", "Eletrônicos",
			    'fato_vendas'[Nome da Categoria] = "Fishing", "Pesca",
			    'fato_vendas'[Nome da Categoria] = "Fitness Accessories", "Fitness",
			    'fato_vendas'[Nome da Categoria] = "Garden", "Jardim",
			    'fato_vendas'[Nome da Categoria] = "Girls' Apparel", "Vestuário",
			    'fato_vendas'[Nome da Categoria] = "Golf Apparel", "Vestuário",
			    'fato_vendas'[Nome da Categoria] = "Golf Bags & Carts", "Esportivos",
			    'fato_vendas'[Nome da Categoria] = "Golf Balls", "Esportivos",
			    'fato_vendas'[Nome da Categoria] = "Golf Gloves", "Esportivos",
			    'fato_vendas'[Nome da Categoria] = "Health and Beauty", "Saúde",
			    'fato_vendas'[Nome da Categoria] = "Hockey", "Esportivos",
			    'fato_vendas'[Nome da Categoria] = "Hunting & Shooting", "Controlados",
			    'fato_vendas'[Nome da Categoria] = "Indoor/Outdoor Games", "Jogos",
			    'fato_vendas'[Nome da Categoria] = "Kids' Golf Clubs", "Esportivos",
			    'fato_vendas'[Nome da Categoria] = "Lacrosse", "Esportivos",
			    'fato_vendas'[Nome da Categoria] = "Men's Clothing", "Vestuário",
			    'fato_vendas'[Nome da Categoria] = "Men's Footwear", "Calçados",
			    'fato_vendas'[Nome da Categoria] = "Men's Golf Clubs", "Esportivos",
			    'fato_vendas'[Nome da Categoria] = "Music", "Mídias",
			    'fato_vendas'[Nome da Categoria] = "Pet Supplies", "Pets",
			    'fato_vendas'[Nome da Categoria] = "Shop By Sport", "Esportivos",
			    'fato_vendas'[Nome da Categoria] = "Soccer", "Esportivos",
			    'fato_vendas'[Nome da Categoria] = "Strength Training", "Fitness",
			    'fato_vendas'[Nome da Categoria] = "Tennis & Racquet", "Esportivos",
			    'fato_vendas'[Nome da Categoria] = "Toys", "Brinquedos",
			    'fato_vendas'[Nome da Categoria] = "Trade-In", "Recondicionados",
			    'fato_vendas'[Nome da Categoria] = "Water Sports", "Esportivos",
			    'fato_vendas'[Nome da Categoria] = "Women's Clothing", "Vestuário",
			    'fato_vendas'[Nome da Categoria] = "Women's Golf Clubs", "Esportivos",
			
			    "Outros"
			)
			
			```
		lineageTag: 5110061a-af83-4aa1-902c-20514aad91ea
		summarizeBy: none

		annotation SummarizationSetBy = Automatic

	partition fato_vendas = m
		mode: import
		source = ```
				let
				    Fonte = DataCoSupplyChainDataset,
				    
				    ListaCorrecao = {
				
				        // ===== ENCODING QUEBRADO =====
				        {"AfganistÃ¡n", "Afeganistão"},
				        {"AzerbaiyÃ¡n", "Azerbaijão"},
				        {"BÃ©lgica", "Bélgica"},
				        {"BangladÃ©s", "Bangladesh"},
				        {"BarÃ©in", "Barein"},
				        {"BenÃ­n", "Benim"},
				        {"ButÃ¡n", "Butão"},
				        {"CamerÃºn", "Camarões"},
				        {"Emiratos Ãrabes Unidos", "Emirados Árabes Unidos"},
				        {"EspaÃ±a", "Espanha"},
				        {"EtiopÃ­a", "Etiópia"},
				        {"GabÃ³n", "Gabão"},
				        {"HungrÃ­a", "Hungria"},
				        {"IrÃ¡n", "Irã"},
				        {"JapÃ³n", "Japão"},
				        {"KazajistÃ¡n", "Cazaquistão"},
				        {"KirguistÃ¡n", "Quirguistão"},
				        {"LÃ­bano", "Líbano"},
				        {"MÃ©xico", "México"},
				        {"NÃ­ger", "Níger"},
				        {"OmÃ¡n", "Omã"},
				        {"PakistÃ¡n", "Paquistão"},
				        {"PanamÃ¡", "Panamá"},
				        {"PapÃºa Nueva Guinea", "Papua-Nova Guiné"},
				        {"PerÃº", "Peru"},
				        {"RepÃºblica Checa", "República Tcheca"},
				        {"TaiwÃ¡n", "Taiwan"},
				        {"TÃºnez", "Tunísia"},
				        {"TayikistÃ¡n", "Tadjiquistão"},
				        {"TurquÃ­a", "Turquia"},
				        {"UzbekistÃ¡n", "Uzbequistão"},
				
				        // ===== ESPANHOL → PORTUGUÊS =====
				        {"Alemania", "Alemanha"},
				        {"Argelia", "Argélia"},
				        {"Austria", "Áustria"},
				        {"Belice", "Belize"},
				        {"Bielorrusia", "Bielorrússia"},
				        {"Bosnia y Herzegovina", "Bósnia e Herzegovina"},
				        {"Camboya", "Camboja"},
				        {"Canada", "Canadá"},
				        {"Chad", "Chade"},
				        {"Corea del Sur", "Coreia do Sul"},
				        {"Costa de Marfil", "Costa do Marfim"},
				        {"Croacia", "Croácia"},
				        {"Dinamarca", "Dinamarca"},
				        {"Eslovenia", "Eslovênia"},
				        {"Finlandia", "Finlândia"},
				        {"Francia", "França"},
				        {"Georgia", "Geórgia"},
				        {"Grecia", "Grécia"},
				        {"Guayana Francesa", "Guiana Francesa"},
				        {"India", "Índia"},
				        {"Indonesia", "Indonésia"},
				        {"Italia", "Itália"},
				        {"Jordania", "Jordânia"},
				        {"Kenia", "Quênia"},
				        {"Libia", "Líbia"},
				        {"Lituania", "Lituânia"},
				        {"Marruecos", "Marrocos"},
				        {"Namibia", "Namíbia"},
				        {"Nueva Zelanda", "Nova Zelândia"},
				        {"PaÃ­ses Bajos", "Países Baixos"},
				        {"Polonia", "Polônia"},
				        {"Rumania", "Romênia"},
				        {"Rusia", "Rússia"},
				        {"Suecia", "Suécia"},
				        {"Suiza", "Suíça"},
				        {"Tailandia", "Tailândia"},
				        {"Ucrania", "Ucrânia"},
				        {"Venezuela", "Venezuela"},
				        {"Zambia", "Zâmbia"},
				        {"Zimbabue", "Zimbábue"},
				
				        // ===== PADRONIZAÇÃO DE NOMES =====
				        {"RD do Congo", "República Democrática do Congo"},
				        {"Republica del Congo", "República do Congo"},
				        {"Guinea-Bissau", "Guiné-Bissau"},
				        {"Hong Kong", "Hong Kong"},
				        {"Myanmar (Birmania)", "Myanmar"},
				        {"SudAfrica", "África do Sul"},
				        {"Singapur", "Singapura"},
				        {"Sierra Leona", "Serra Leoa"},
				        {"Yibuti", "Djibuti"},
				        {"Yemen", "Iêmen"},
				        {"Suazilandia", "Essuatíni"},
				        {"Macedonia", "Macedônia"},
				        {"Trinidad y Tobago", "Trinidad e Tobago"},
				        {"Bosnia y Herzegovina", "Bósnia e Herzegovina"},
				        {"Guinea Ecuatorial", "Guiné Equatorial"},
				
				        // ===== RESTANTES (ENCODING + ESPANHOL + PADRONIZAÇÃO) =====    
				        {"Albania", "Albânia"},
				        {"Armenia", "Armênia"},
				        {"Australia", "Austrália"},
				        {"Bolivia", "Bolívia"},
				        {"Bulgaria", "Bulgária"},
				        {"Colombia", "Colômbia"},
				        {"Ecuador", "Equador"},
				        {"Egipto", "Egito"},
				        {"Estonia", "Estônia"},
				        {"Ghana", "Gana"},
				        {"Guinea", "Guiné"},
				        {"Liberia", "Libéria"},
				        {"Malasia", "Malásia"},
				        {"Mauritania", "Mauritânia"},
				        {"Moldavia", "Moldávia"},
				        {"Mozambique", "Moçambique"},
				        {"Nicaragua", "Nicarágua"},
				        {"Nigeria", "Nigéria"},
				        {"Paraguay", "Paraguai"},
				        {"Siria", "Síria"},
				        {"Surinam", "Suriname"},
				        {"Tanzania", "Tanzânia"},
				        {"Uruguay", "Uruguai"},
				        {"Vietnam", "Vietnã"},
				
				        // Encoding quebrado que ainda sobrou
				        {"Arabia SaudÃ­", "Arábia Saudita"},
				        {"HaitÃ­", "Haiti"},
				        {"RepÃºblica Centroafricana", "República Centro-Africana"},
				        {"RepÃºblica de Gambia", "Gâmbia"},
				        {"RepÃºblica del Congo", "República do Congo"},
				        {"RepÃºblica DemocrÃ¡tica del Congo", "República Democrática do Congo"},
				        {"SÃ¡hara Occidental", "Saara Ocidental"},
				        {"SudÃ¡n", "Sudão"},
				        {"SudÃ¡n del Sur", "Sudão do Sul"},
				        {"TurkmenistÃ¡n", "Turcomenistão"}
				    },
				
				    // 2. Aplicação em massa das substituições na coluna "Order Country"
				    CorrigirPaises = List.Accumulate(
				        ListaCorrecao, 
				        Fonte, 
				        (estado, atual) => Table.ReplaceValue(estado, atual{0}, atual{1}, Replacer.ReplaceValue, {"Order Country"})
				    ),
				
				    // 3. Seleção de Colunas Relevantes
				    ColunasSelecionadas = Table.SelectColumns(CorrigirPaises, {
				        "order date (DateOrders)", "shipping date (DateOrders)", "Type", 
				        "Days for shipping (real)", "Days for shipment (scheduled)", 
				        "Delivery Status", "Late_delivery_risk", "Category Name", 
				        "Customer Segment", "Department Name", "Market", "Order City", 
				        "Order Country", "Order Region", "Order Status", "Product Name", 
				        "Sales", "Order Profit Per Order", "Shipping Mode", "Order Id"
				    }),
				
				    // 4. Tipagem de Dados
				    AjustarTipos = Table.TransformColumnTypes(ColunasSelecionadas, {
				        {"order date (DateOrders)", type date}, 
				        {"shipping date (DateOrders)", type date},
				        {"Sales", type number},
				        {"Order Profit Per Order", type number},
				        {"Days for shipping (real)", Int64.Type},
				        {"Days for shipment (scheduled)", Int64.Type},
				        {"Late_delivery_risk", Int64.Type}
				    }),
				
				    // 5. Traduções de Mercado
				    TraduzirMercado = Table.AddColumn(AjustarTipos, "Mercado Global", each 
				        if [Market] = "Europe" then "Europa"
				        else if [Market] = "Pacific Asia" then "Ásia-Pacífico"
				        else if [Market] = "LATAM" then "América Latina"
				        else if [Market] = "Africa" then "África"
				        else if [Market] = "USCA" then "EUA e Canadá"
				        else [Market], type text),
				
				    // 6. Adição de Flags (URLs para visual de mapa/tabela)
				    AdicionarBandeira = Table.AddColumn(TraduzirMercado, "Flag", each
				        if [Mercado Global] = "Europa" then "https://flagcdn.com/w40/eu.png"
				        else if [Mercado Global] = "Ásia-Pacífico" then "https://flagcdn.com/w40/un.png"
				        else if [Mercado Global] = "América Latina" then "https://flagcdn.com/w40/br.png"
				        else if [Mercado Global] = "África" then "https://flagcdn.com/w40/za.png"
				        else if [Mercado Global] = "EUA e Canadá" then "https://raw.githubusercontent.com/gustavolima007/DataCo-SupplyChain-Analysis/main/figma/eua-ca.png"
				        else null, type text),
				
				    // 7. Traduções de Modalidade e Status
				    TraduzirModalidade = Table.AddColumn(AdicionarBandeira, "Modalidade de Entrega", each 
				        if [Shipping Mode] = "First Class" then "Primeira Classe"
				        else if [Shipping Mode] = "Second Class" then "Segunda Classe"
				        else if [Shipping Mode] = "Standard Class" then "Classe Padrão"
				        else if [Shipping Mode] = "Same Day" then "Entrega no Mesmo Dia"
				        else [Shipping Mode], type text),
				
				    TraduzirStatus = Table.AddColumn(TraduzirModalidade, "Status do Pedido", each 
				        if [Delivery Status] = "Shipping on time" then "No Prazo"
				        else if [Delivery Status] = "Late delivery" then "Em Atraso"
				        else if [Delivery Status] = "Shipping canceled" then "Cancelado"
				        else if [Delivery Status] = "Advance shipping" then "Antecipado"
				        else [Delivery Status], type text),
				
				    // 8. Renomeação Final para Português
				    RenomearGeral = Table.RenameColumns(TraduzirStatus, {
				        {"order date (DateOrders)", "Data do Pedido"},
				        {"shipping date (DateOrders)", "Data de Envio"},
				        {"Days for shipping (real)", "Dias Envio Real"},
				        {"Days for shipment (scheduled)", "Dias Envio Programado"},
				        {"Order Profit Per Order", "Lucro do Pedido"},
				        {"Sales", "Vendas"},
				        {"Type", "Tipo de Pagamento"},
				        {"Category Name", "Nome da Categoria"},
				        {"Customer Segment", "Segmento do Cliente"},
				        {"Department Name", "Nome do Departamento"},
				        {"Order City", "Cidade do Pedido"},
				        {"Order Country", "País do Pedido"},
				        {"Order Region", "Região do Pedido"},
				        {"Order Status", "Situação do Pedido"},
				        {"Product Name", "Nome do Produto"},
				        {"Order Id", "ID do Pedido"},
				        {"Late_delivery_risk", "Risco de Atraso"}
				    }),
				    
				    // 9. Limpeza final de colunas redundantes
				    RemoverColunasOriginais = Table.RemoveColumns(RenomearGeral, {"Market", "Shipping Mode", "Delivery Status"})
				in
				    RemoverColunasOriginais
				```

	annotation PBI_NavigationStepName = Navegação

	annotation PBI_ResultType = Table

